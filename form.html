<!--Russell Carter-->
<!DOCTYPE html>
<html lang="en">
	<head>
		<meta charset="UTF-8" />
		<title>Signup Form</title>
		<link
			rel="stylesheet"
			href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css"
			integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T"
			crossorigin="anonymous"
		/>
	</head>
	<body onload="checkCookie()">
		<div class="p-3 mb-2 bg-light text-dark">
			<form
				action="https://signupapp2.com/signupapp/signups/process"
				method="post"
				onsubmit="validateEmail()"
				name="form"
			>
				<div class="mx-auto" id="formid">
					<label for="exampleInputEmail1">Email Address</label>
					<input
						type="text"
						name="signup.emailAddress"
						id="emailAddress"
						placeholder="Enter email"
						class="form-control"
						required
					/>

					<input name="signup.listCode" type="hidden" value="TRADEDAY" />

					<input name="signup.sourceId" type="hidden" value="XXTEST" />

					<input
						name="signup.welcomeEmailTemplateName"
						type="hidden"
						value="tradeday_generic"
					/>

					<input type="submit" value="Submit" class="btn btn-primary" />
				</div>
			</form>
		</div>
		<script type="text/javascript">
			function checkCookie() {
				// if a cookie exists, then display the thank you
				document.cookie && document.write("Thank you for signing up!");
			}

			function validateEmail() {
				var email = document.getElementById("emailAddress").value;
				var regex = /^[^\s@]+@[^\s@]+\.[^\s@]+$/; // Regular Expression of a valid email

				if (regex.test(email)) {
					event.preventDefault(); // stops the redirection on successful signup
					createCookie();
				}
				return regex.test(email);
			}

			function createCookie() {
				// called when a valid email is given through validateEmail()

				var cookievalue = encodeURI(
					document.getElementById("emailAddress").value
				);
				var now = new Date();
				var time = now.getTime();
				var expireTime = time + 86400 * 1000; // expires in one day upon creation
				now.setTime(expireTime);
				var expires = now.toGMTString(); // must be in GMT string format

				document.cookie = `name=${cookievalue};expires=${expires};`;
				// should show thank you instead of cookie
				document.write("<h1>Thank you for signing up</h1>");
				document.body.style.backgroundColor = "#BEBEBE";
				console.log(document.cookie);
			}
		</script>
		<style>
			body {
				background-color: #bebebe;
			}
			#formid {
				width: 60%;
			}
			#emailAddress {
				margin-bottom: 20px;
			}
		</style>
	</body>
</html>
